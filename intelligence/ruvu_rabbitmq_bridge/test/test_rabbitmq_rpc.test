<launch>
  <node name="rabbitmq_bridge" pkg="ruvu_rabbitmq_bridge" type="rabbitmq_bridge" required="true">
    <rosparam file="$(find ruvu_rabbitmq_bridge)/test/test_rabbitmq_bridge.yaml" command="load" />
    <param name="rabbitmq_host" value="$(optenv RABBITMQ_HOST 127.0.0.1)" />
  </node>

  <node name="rabbitmq_bridge_inverse" pkg="ruvu_rabbitmq_bridge" type="rabbitmq_bridge" required="true">
    <rosparam file="$(find ruvu_rabbitmq_bridge)/test/test_rabbitmq_bridge_inverse.yaml" command="load" />
    <param name="rabbitmq_host" value="$(optenv RABBITMQ_HOST 127.0.0.1)" />
    <remap from="rpc_test" to="rpc_test_client"/>
  </node>

  <node name="rpc_test_server_node" pkg="ruvu_rabbitmq_bridge" type="rpc_test_server_node">
    <remap from="input" to="rpc_test_client"/>
  </node>

  <test test-name="rpc_test_client_node" pkg="ruvu_rabbitmq_bridge" type="rpc_test_client_node">
    <remap from="output" to="rpc_test"/>
  </test>
</launch>